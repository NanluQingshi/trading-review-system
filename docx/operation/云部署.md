# ☁️ 交易复盘系统：从开发到云端部署全流程指南

本指南将指导您如何像专业软件公司一样管理代码版本，并提供两种主流的云端部署方案。

---

## 🛠 一、 代码管理与版本发布 (Git Workflow)

在将代码交给客户或部署到生产环境之前，必须进行规范的版本标记。

### 1. 分支管理
*   `main`：生产分支，仅存放经过测试的稳定代码。
*   `develop`：开发分支，日常功能开发在此进行。

### 2. 标记版本 (Git Tag)
当完成一个阶段的开发（如接入 MySQL 并重构 UI）后，应发布一个版本：
```bash
# 1. 确保在 main 分支
git checkout main
git merge develop

# 2. 打版本标签 (遵循语义化版本语义，如 v1.1.0)
# - m: 后面跟的是版本说明
git tag -a v1.1.0 -m "发布 v1.1.0: 接入 MySQL 数据库，重构 Ant Design 现代化 UI"

# 3. 推送代码和标签到远程仓库
git push origin main --tags
```

---

## 🚀 二、 方案 A：Docker 容器化部署 (推荐)

**适用场景**：您拥有一台云服务器（ECS/CVM），希望完全掌控环境，且方便未来迁移。

### 1. 准备工作
在云服务器上安装 Docker 和 Docker Compose。

### 2. 部署步骤
1.  **上传代码**：在服务器上 `git clone` 您的仓库。
2.  **配置环境**：在 `server/.env` 中设置生产环境数据库密码。
3.  **一键启动**：
    ```bash
    docker-compose up -d --build
    ```
4.  **数据库初始化**：
    ```bash
    docker exec -it trading-server node init-db.js
    ```

### 3. 更新流程
当您在本地修改了代码并推送到 Git 后：
```bash
git pull origin main
docker-compose up -d --build  # 只有变动的模块会重新构建，实现快速更新
```

---

## ☁️ 三、 方案 B：云原生托管服务 (SaaS 模式)

**适用场景**：追求极简运维，希望前端和后端分别托管在专业的云服务平台上。

### 1. 前端托管 (Vercel / Netlify / 阿里云 OSS)
*   **操作**：将 GitHub 仓库关联到 Vercel。
*   **优势**：
    *   **自动部署**：每次 `git push`，Vercel 会自动构建并发布。
    *   **全球加速**：自带 CDN，客户访问速度极快。
    *   **预览功能**：每个 Pull Request 都会生成一个独立的预览链接。

### 2. 后端托管 (阿里云 FC / AWS Lambda / Render)
*   **操作**：使用云平台的“容器镜像服务”或“Web 托管服务”。
*   **数据库**：购买云数据库 **RDS MySQL**。
*   **优势**：
    *   **弹性伸缩**：没客户访问时不计费或低计费，访问量大时自动扩容。
    *   **免运维**：无需关心服务器补丁、磁盘空间等。

### 3. 部署步骤
1.  **数据库**：在云平台购买 RDS 实例，获取连接地址。
2.  **后端**：在 Render 或阿里云上关联仓库，设置环境变量（DB_HOST 等）。
3.  **前端**：在 Vercel 上关联仓库，设置 `API_BASE_URL` 指向后端云地址。

---

## 📊 四、 两种方案对比

| 特性 | 方案 A：Docker (自建) | 方案 B：云原生 (托管) |
| :--- | :--- | :--- |
| **成本** | 固定（服务器月租） | 弹性（按量计费） |
| **运维难度** | 中等（需管理 Docker） | 极低（平台全管） |
| **灵活性** | 极高（可任意配置） | 受平台限制 |
| **更新体验** | 手动执行命令或配置脚本 | 自动（Git Push 即部署） |
| **推荐人群** | 极客、希望省钱、有服务器基础 | 独立开发者、追求效率、SaaS 创业者 |

---

## 📝 五、 运维 Checklist

1.  **备份**：无论哪种方案，务必开启云数据库的**自动备份**。
2.  **监控**：配置云平台的报警规则，当 CPU 超过 80% 或服务挂掉时发送短信/邮件。
3.  **日志**：定期检查后端日志，关注客户遇到的 500 错误。
4.  **安全**：
    *   开启 HTTPS（SSL 证书）。
    *   数据库禁止外网直接访问，仅允许后端服务器 IP 访问。

---

**现在，您可以根据您的预算和技术偏好选择合适的方案。如果您需要针对某个特定云平台（如阿里云）的详细点击步骤，请告诉我！**